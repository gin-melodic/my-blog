---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Get the 3 most recent posts
const allPosts = await getCollection('blog', ({ data }) => {
  return !data.draft;
});

// Sort by date in descending order
allPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

// Get the 3 most recent posts
const recentPosts = allPosts.slice(0, 3);
---

<BaseLayout 
  title="MELODIC-GIN'S BLOG" 
  description="Welcome to my blog! I'm MELODIC-GIN, an AI Full-Stack Engineer and Agent Architect. Here I share my journey in building end-to-end AI applications and explore the intersection of modern web technologies and artificial intelligence."
>
  <div class="text-center py-20">
    <h1 class="text-6xl font-black mb-6 tracking-tighter text-white animate-fade-in">
      MELODIC-GIN'S <span class="text-bauhaus-blue">BLOG</span>
    </h1>
    <p class="text-2xl mb-12 text-gray-100 max-w-2xl mx-auto">
      Building the Future with AI & Modern Web Technologies
    </p>
    
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-16">
      {recentPosts.map((post: { slug: any; data: { title: unknown; description: unknown; pubDate: string | number | Date; }; }, index: number) => (
        <a 
          href={`/posts/${post.slug}/`} 
          class="flex flex-col p-6 bg-white/10 text-white rounded-xl backdrop-blur-lg border border-white/20 hover:shadow-2xl hover:border-bauhaus-blue/50 transition-all duration-300 transform hover:-translate-y-1 overflow-hidden"
          style={`animation: fadeInUp 0.6s ease-out ${index * 0.1 + 0.1}s both;`}
        >
          <div class="flex items-center mb-4">
            <time datetime={post.data.pubDate.toString()} class="text-sm font-medium bg-bauhaus-blue/20 px-3 py-1 rounded-full">
              {new Date(post.data.pubDate).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}
            </time>
          </div>
          <h3 class="text-xl font-bold text-white mb-3 line-clamp-2 leading-tight">{post.data.title}</h3>
          <p class="text-gray-200 text-sm mb-4 line-clamp-3 leading-relaxed flex-grow">{post.data.description}</p>
          <div class="pt-4 border-t border-white/10 flex items-center justify-between">
            <span class="text-bauhaus-blue text-sm font-medium">Read more</span>
            <span class="text-white/50">→</span>
          </div>
        </a>
      ))}
    </div>
    
    <a href="/posts" class="inline-block bg-bauhaus-blue bg-white/20 text-white px-12 py-4 rounded-lg font-bold hover:bg-purple-600 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl border-2 border-bauhaus-blue hover:border-purple-600">
      View All Posts →
    </a>
  </div>
</BaseLayout>